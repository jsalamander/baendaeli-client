<!doctype html>
<html lang="en" data-theme="dark">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Baendae.li Payment</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link href="https://cdn.jsdelivr.net/npm/daisyui@4.4.20/dist/full.min.css" rel="stylesheet" type="text/css" />
	<style>
		.hidden { display: none; }
	</style>
</head>
<body class="flex flex-col min-h-screen bg-base-900">
	<!-- Navbar with integrated status -->
	<nav class="navbar bg-base-800 border-b border-base-700">
		<div class="flex-1">
			<a class="btn btn-ghost text-xl" href="/">Solibändäli</a>
		</div>
		<div class="flex-none">
			<div class="badge badge-dash badge-primary badge-lg" id="status">
				<span class="status status-sm status-success"></span>
				<span>Zahlungsformular wird erstellt...</span>
			</div>
		</div>
	</nav>

	<!-- Main Content -->
	<main class="flex-1 flex items-center justify-center p-4">
		<div class="card bg-base-800 border border-base-700 shadow-xl w-full max-w-md">
			<div class="card-body">
				<!-- Success Banner (hidden by default) -->
				<div class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur" id="successBanner">
					<div class="alert alert-success alert-lg shadow-lg max-w-sm">
						<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
						<span class="font-bold">Danke, dein Solibändeli wird ausgegeben!</span>
					</div>
				</div>

				<h2 class="card-title text-2xl">Spenden</h2>
				<p class="text-base-content/70">Scanne den QR-Code mit deinem Smartphone, um das Solibändeli zu bezahlen.</p>
				<div class="bg-base-700 rounded-lg border border-dashed border-base-600 p-4 flex items-center justify-center min-h-[220px]" id="qr">
					<div class="text-center">
						<svg class="inline-block w-8 h-8 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
							<circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
							<path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
						</svg>
						<p class="mt-2 text-sm">Warten auf QR Code...</p>
					</div>
				</div>

				<!-- Error Message -->
				<div class="alert alert-error hidden" id="errorContainer">
					<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l-2-2m0 0l-2-2m2 2l2-2m-2 2l-2 2" /></svg>
					<span id="error"></span>
				</div>

				<!-- Retry Button -->
				<button class="btn btn-primary w-full hidden" id="retry">Try again</button>

				<!-- Expiry Countdown -->
				<div class="divider my-2"></div>
				<div class="text-xs text-base-content/60 text-center">
					<span id="expiryMeta">Gültig für --:--</span>
				</div>
			</div>
		</div>
	</main>

	<!-- Version Badge (fixed position on left) -->
	<div class="fixed bottom-4 left-4 badge badge-outline text-xs">v{{.Version}}</div>

	<!-- Internet & Gateway Status (fixed position on right, horizontal) -->
	<div class="fixed bottom-4 right-4 flex flex-row gap-2 flex-wrap max-w-[calc(100vw-8rem)]">
		<div class="flex items-center gap-2 text-xs badge badge-outline">
			<div class="w-2 h-2 rounded-full bg-warning" id="internetDot"></div>
			<span id="internetStatusText">Internet...</span>
		</div>
		<div class="flex items-center gap-2 text-xs badge badge-outline">
			<div class="w-2 h-2 rounded-full bg-warning" id="gatewayDot"></div>
			<span id="gatewayStatusText">Gateway...</span>
		</div>
		<div class="text-xs text-base-content/60 badge badge-ghost">
			<span id="gatewayMeta">...</span>
		</div>
	</div>

	<!-- Scripts -->
	<script src="/ui.js"></script>
	<script src="/api.js"></script>
	<script src="/qr.js"></script>
	<script src="/main.js"></script>
</body>
</html>
